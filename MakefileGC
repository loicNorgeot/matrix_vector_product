# http://gl.developpez.com/tutoriel/outil/makefile/
#
# Plusieurs Variables sont accessibles pour chaque règle:
# 	    $< correspond au nom de la première dépendance d'une règle
# 	    $@ correspond au nom de la cible
# 	    $^ correspond à la liste des dépendances
#
# La cible .PHONY sert pour clean et mrproper
# Toutes ses dépendances seront systématiquement reconstruites
#
# Paragraphe 6 : Construction automatique à partir des sources


CXX=icpc
CXXFLAGS=-fopenmp -O3 -lm
EXEC=main

all: $(EXEC)



main : vector.o csrmatrix.o gc.o matrix.o binaryIO.o mainGC.o
	$(CXX) -o $@ $^ $(CXXFLAGS)

vector.o : vector.cpp vector.h
	$(CXX) -c $< $(CXXFLAGS)

csrmatrix.o : csrmatrix.cpp csrmatrix.h
	$(CXX) -c $< $(CXXFLAGS)

gc.o : gc.cpp gc.h
	$(CXX) -c $< $(CXXFLAGS)

matrix.o : matrix.cpp matrix.h
	 $(CXX) -c $< $(CXXFLAGS)	

binaryIO.o : binaryIO.cpp binaryIO.h
	$(CXX) -c $< $(CXXFLAGS)

mainGC.o : mainGC.cpp vector.h csrmatrix.h gc.h matrix.h binaryIO.h
	$(CXX) -c $< $(CXXFLAGS)



.PHONY: clean mrproper

clean:
	rm -rf *.o

mrproper: clean
	rm -rf $(EXEC)	  
